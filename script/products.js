var products=[
    {
       img_url:"https://icdn.bottlenose.wine/images/full/594123.png?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "La Cappuccina Sauvignon Blanc VNS",
       price : "2860",
       category : "White Wine",
       region : "Italy",
       flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
       rating : "4"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/485479.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Presqu'ile Pinot Noir ",
       price : "5890",
       category : "Red Wine",
       region : "California",
       flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
       rating : "5"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/592151.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "90+ Cellars Lot 75 Pinot Noir 2019",
       price : "3590",
       category : "Red Wine",
       region : "California",
       flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
       rating : "3"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/623751.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Adaptation Cabernet Sauvignon 2018",
       price : "4990",
       category : "Red Wine",
       region : "California",
       flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
       rating : "4"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/640093.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Amity Pinot Noir",
       price : "2400",
       category : "Red Wine",
       region : "USA",
       flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
       rating : "5"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/627517.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Apothic Winemaker's Blend Red",
       price : "2860",
       category : "Red Wine",
       region : "California",
       flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
       rating : "3"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/524364.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Alois Lageder Pinot Grigio",
       price : "4990",
       category : "White Wine",
       region : "Italy",
       flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
       rating : "4"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/559284.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Argiolas Costamolino",
       price : "7890",
       category : "White Wine",
       region : "Italy",
       flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
       rating : "5"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/587109.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Burgans AlbariÃ±o",
       price : "1760",
       category : "White Wine",
       region : "Spain",
       flag : "https://e0.pxfuel.com/wallpapers/630/608/desktop-wallpaper-spain-flag-in-collection.jpg",
       rating : "3"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/591550.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Domaine Savary Chablis Vieilles Vignes",
       price : "5970",
       category : "White Wine",
       region : "France",
       flag : "https://cdn.britannica.com/82/682-004-F0B47FCB/Flag-France.jpg",
       rating : "3"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/578735.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "90+ Cellars Lot 50 Prosecco",
       price : "1990",
       category : "Sparkling Wine",
       region : "Italy",
       flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
       rating : "4"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/628145.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Barefoot Bubbly Brut Cuvee",
       price : "5860",
       category : "Sparkling Wine",
       region : "California",
       flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
       rating : "4"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/590460.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Billecart-Salmon Brut Nature",
       price : "19990",
       category : "Sparkling Wine",
       region : "France",
       flag : "https://cdn.britannica.com/82/682-004-F0B47FCB/Flag-France.jpg",
       rating : "5"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/593095.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : " Billecart-Salmon Brut RÃ©serve",
       price : "7950",
       category : "Sparkling Wine",
       region : "France",
       flag : "https://cdn.britannica.com/82/682-004-F0B47FCB/Flag-France.jpg",
       rating : "5"
    },
    {
       img_url:"https://icdn.bottlenose.wine/images/full/547761.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
       name : "Bodegas Dios Baco Amontillado",
       price : "6960",
       category : "Dessert Wine",
       region : "Spain",
       flag : "https://e0.pxfuel.com/wallpapers/630/608/desktop-wallpaper-spain-flag-in-collection.jpg",
       rating : "3"
    },
    {
      img_url:"https://icdn.bottlenose.wine/images/full/552730.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Juve y Camps Cava Brut RosÃ©",
      price : "3550",
      category : "Sparkling Wine",
      region : "Spain",
      flag : "https://e0.pxfuel.com/wallpapers/630/608/desktop-wallpaper-spain-flag-in-collection.jpg",
      rating : "4"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/507252.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : " Juve y Camps Reserva de la Familia Brut Nature",
      price : "3290",
      category : "Sparkling Wine",
      region : "Spain",
      flag : "https://e0.pxfuel.com/wallpapers/630/608/desktop-wallpaper-spain-flag-in-collection.jpg",
      rating : "5"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/578521.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : " La Marca Prosecco",
      price : "2950",
      category : "Sparkling Wine",
      region : "Italy",
      flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
      rating : "3"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/531395.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Carpano Antica Formula Vermouth",
      price : "7960",
      category : "Dessert Wine",
      region : "Italy",
      flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
      rating : "5"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/553192.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Florio Sweet Marsala",
      price : "1960",
      category : "Dessert Wine",
      region : "Italy",
      flag: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Flag_of_Italy_with_border.svg/1500px-Flag_of_Italy_with_border.svg.png",
      rating : "4"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/592463.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Fonseca Bin No. 27 Finest Reserve Porto",
      price : "5900",
      category : "Dessert Wine",
      region : "Portugal",
      flag : "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Flag_of_Portugal.svg/255px-Flag_of_Portugal.svg.png",
      rating : "5"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/238824.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Kopke Fine Ruby Port",
      price : "6960",
      category : "Dessert Wine",
      region : "Portugal",
      flag : "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Flag_of_Portugal.svg/255px-Flag_of_Portugal.svg.png",
      rating : "3"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/592464.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Taylor Fladgate Tawny Port 20 year old",
      price : "5780",
      category : "Dessert Wine",
      region : "Portugal",
      flag : "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Flag_of_Portugal.svg/255px-Flag_of_Portugal.svg.png",
      rating : "4"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/557934.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Taylor Fladgate Tawny Port 10 year old",
      price : "5780",
      category : "Dessert Wine",
      region : "Portugal",
      flag : "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Flag_of_Portugal.svg/255px-Flag_of_Portugal.svg.png",
      rating : "5"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/560353.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Warre's Fine White Port",
      price : "2930",
      category : "Dessert Wine",
      region : "France",
      flag : "https://cdn.britannica.com/82/682-004-F0B47FCB/Flag-France.jpg",
      rating : "5"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/474165.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Beringer Main & Vine White Zinfandel",
      price : "2480",
      category : "Rose Wine",
      region : "California",
      flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
      rating : "4"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/564127.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Bieler Pere et Fils Sabine RosÃ©",
      price : "3780",
      category : "Rose Wine",
      region : "France",
      flag : "https://cdn.britannica.com/82/682-004-F0B47FCB/Flag-France.jpg",
      rating : "3"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/470580.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Buckle Family Wine Colorado Rose",
      price : "4950",
      category : "Rose Wine",
      region : "USA",
      flag: "https://cdn.britannica.com/33/4833-004-828A9A84/Flag-United-States-of-America.jpg",
      rating : "5"
   },
   {
      img_url:"https://icdn.bottlenose.wine/images/full/189600.jpg?ar=1&fit=fill&fill=solid&fill-color=fff&auto=format&ixlib=imgixjs-3.6.1&w=134",
      name : "Joseph Cattin CrÃ©mant d'Alsace RosÃ©",
      price : "6780",
      category : "Rose Wine",
      region : "France",
      flag : "https://cdn.britannica.com/82/682-004-F0B47FCB/Flag-France.jpg",
      rating : "4"
   }
]


const wineCheckboxes = {
   red: document.getElementById('red-wine'),
   white: document.getElementById('white-wine'),
   sparkling: document.getElementById('sparkling-wine'),
   rose: document.getElementById('rose-wine'),
   five: document.getElementById('five-stars'),
   four: document.getElementById('four-stars'),
   three: document.getElementById('three-stars'),
   Italy : document.getElementById(`Italy`),
   France : document.getElementById(`France`),
   California : document.getElementById(`California`),
   Spain : document.getElementById(`Spain`),
   Portugal : document.getElementById(`Portugal`),
   Toprated :document.getElementById('sorting'),
   sorting: document.getElementById('sorting')

 };
 
 
 function filterProductsByCategory() {
   return products.filter(product => {
     if (
       (wineCheckboxes.red.checked && product.category === 'Red Wine') ||
       (wineCheckboxes.white.checked && product.category === 'White Wine') ||
       (wineCheckboxes.sparkling.checked && product.category === 'Sparkling Wine') ||
       (wineCheckboxes.rose.checked && product.category === 'Rose Wine') ||
       (wineCheckboxes.five.checked && product.rating=="5") ||
       (wineCheckboxes.four.checked && product.rating=="4") ||
       (wineCheckboxes.three.checked && product.rating=="3") ||
       (wineCheckboxes.Italy.checked && product.region==='Italy') ||
       (wineCheckboxes.California.checked && product.region==='California') ||
       (wineCheckboxes.Spain.checked && product.region==='Spain') ||
       (wineCheckboxes.France.checked && product.region==='France') ||
       (wineCheckboxes.Portugal.checked && product.region==='Portugal') 

     ) {
       return true;
     }
     return false;
   });
 }



 
 let currentSort = 'default'; 
const productsPerPage = 9;
let currentPage = 1;



function displayFilteredProducts(page) {
   var filteredProducts;
    if(filterProductsByCategory().length==0){
      filteredProducts=products;
    }
    else{
      filteredProducts=filterProductsByCategory();
    }
    const sortedProducts = sortProducts(filteredProducts);
   console.log(filteredProducts);
  const productList = document.getElementById('wines');
  productList.innerHTML = '';

  const startIdx = (page - 1) * productsPerPage;
  const endIdx = startIdx + productsPerPage;



  for (let i = startIdx; i < endIdx && i < sortedProducts.length; i++) {
    const product = sortedProducts[i];
    const wines=document.createElement("div");
    var topOfCol=document.createElement("div");
    topOfCol.setAttribute("class","top");

    var rating=document.createElement("span");
    rating.setAttribute("class","rate");
    rating.textContent="â˜… "+product.rating;

    var heart=document.createElement("span");
    heart.setAttribute("class","heart");
    heart.textContent="ðŸ¤";
    
    
    topOfCol.append(rating,heart);

    var wineImg=document.createElement("div");
    wineImg.setAttribute("class","wineimg");
    var image=document.createElement("img");
    image.setAttribute("src",product.img_url);
    wineImg.append(image)

    var nameDiv=document.createElement("div");
    nameDiv.setAttribute("class","nameDiv");
    var name=document.createElement("h4");
    name.textContent=product.name;
    nameDiv.append(name);

    var belowName=document.createElement("div");
    belowName.setAttribute("class","belowName");

    var flag=document.createElement("img");
    flag.setAttribute("src",product.flag);

    var region=document.createElement("span");
    region.textContent=product.region;

    var cat=document.createElement("span");
    cat.textContent=product.category;
    belowName.append(flag,region,cat);

    var line=document.createElement("hr");

    var priceDiv=document.createElement("div");
    priceDiv.setAttribute("class","priceDiv");

    var price=document.createElement("h3");
    price.textContent="â‚¹ "+product.price;
     
    var cart=document.createElement("button");
    cart.textContent="+";
    cart.setAttribute("class","cart");
    priceDiv.append(price,cart);

    const cartPopup = document.createElement("div");
cartPopup.setAttribute("class", "cart-popup");

const popupContent = document.createElement("div");

const popupHeading = document.createElement("h2");
popupHeading.textContent = "Added to Cart Successfully";

const popupButton = document.createElement("button");
popupButton.textContent = "Close";
popupButton.addEventListener("click", () => {
  cartPopup.classList.remove("active");
});

popupContent.append(popupHeading, popupButton);
cartPopup.append(popupContent);
document.body.appendChild(cartPopup);

    cart.addEventListener("click",function(){
      var kart = JSON.parse(localStorage.getItem("cart")) || [];
  kart.push(product);
  localStorage.setItem("cart", JSON.stringify(kart));

  cartPopup.classList.add("active");
    });

    wines.append(topOfCol,wineImg,nameDiv,belowName,line,priceDiv);
    productList.append(wines);

    
  }
}

function displayPagination() {
  const pagination = document.getElementById('pagination');
  pagination.innerHTML = '';

  const totalPages = Math.ceil(products.length / productsPerPage);
  for (let i = 1; i <= totalPages; i++) {
    const pageLink = document.createElement('button');

    pageLink.textContent = i;
    pageLink.classList.add('page-link');

    if (i === currentPage) {
      pageLink.classList.add('active');
    }

    pageLink.addEventListener('click', () => {
      currentPage = i;
      displayFilteredProducts(currentPage);
      displayPagination();
    });

    pagination.appendChild(pageLink);
  }
}

// Initial display
displayFilteredProducts(currentPage);
displayPagination();




function sortProducts(products) {
   switch (currentSort) {
     case 'AtoZ':
       return products.slice().sort((a, b) => a.name.localeCompare(b.name));
     case 'ZtoA':
       return products.slice().sort((a, b) => b.name.localeCompare(a.name));
     case 'LtoH':
       return products.slice().sort((a, b) => a.price - b.price);
     case 'HtoL':
       return products.slice().sort((a, b) => b.price - a.price);
     default:
       return products;
   }
 }


for (const key in wineCheckboxes) {
   wineCheckboxes[key].addEventListener('change', () => {
     currentPage = 1;
     displayFilteredProducts(currentPage);
     displayPagination();
   });
 }



 wineCheckboxes.sorting.addEventListener('change', () => {
   currentSort = wineCheckboxes.sorting.value;
   displayFilteredProducts(currentPage);
   displayPagination();
 });
 